


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>torchx.specs &mdash; PyTorch/TorchX master documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!-- <link rel="stylesheet" href="_static/pygments.css" type="text/css" /> -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.0-beta/dist/katex.min.css" type="text/css" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css" type="text/css" />
  <link rel="stylesheet" href="_static/katex-math.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="torchx.components" href="components.html" />
    <link rel="prev" title="Configuring" href="configure.html" />
  <!-- Google Analytics -->
  
  <!-- End Google Analytics -->
  

  
  <script src="_static/js/modernizr.min.js"></script>

  <!-- Preload the theme fonts -->

<link rel="preload" href="_static/fonts/FreightSans/freight-sans-book.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="_static/fonts/FreightSans/freight-sans-medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="_static/fonts/IBMPlexMono/IBMPlexMono-Medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="_static/fonts/FreightSans/freight-sans-bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="_static/fonts/FreightSans/freight-sans-medium-italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="_static/fonts/IBMPlexMono/IBMPlexMono-SemiBold.woff2" as="font" type="font/woff2" crossorigin="anonymous">

<!-- Preload the katex fonts -->

<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Math-Italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size1-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size4-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size2-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size3-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Caligraphic-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.2/css/all.css" integrity="sha384-vSIIfh2YWi9wW0r9iZe7RJPrKwp6bG+s9QZMoITbCckVJqGCCRhc+ccxNcdpHuYu" crossorigin="anonymous">
</head>

<div class="container-fluid header-holder tutorials-header" id="header-holder">
  <div class="container">
    <div class="header-container">
      <a class="header-logo" href="https://pytorch.org/" aria-label="PyTorch"></a>

      <div class="main-menu">
        <ul>
          <li>
            <a href="https://pytorch.org/get-started">Get Started</a>
          </li>

          <li>
            <a href="https://pytorch.org/ecosystem">Ecosystem</a>
          </li>

          <li>
            <a href="https://pytorch.org/mobile">Mobile</a>
          </li>

          <li>
            <a href="https://pytorch.org/blog/">Blog</a>
          </li>

          <li>
            <a href="https://pytorch.org/tutorials">Tutorials</a>
          </li>

          <li>
            <div id="resourcesDropdownButton" data-toggle="resources-dropdown" class="resources-dropdown">
              <a class="resource-option with-down-orange-arrow">
                Docs
              </a>
              <div class="resources-dropdown-menu">
                <a class="doc-dropdown-option nav-dropdown-item" href="https://pytorch.org/docs/stable/index.html">
                  <span class="dropdown-title">PyTorch</span>
                  <p></p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item" href="https://pytorch.org/audio/stable/index.html">
                  <span class="dropdown-title">torchaudio</span>
                  <p></p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item" href="https://pytorch.org/text/stable/index.html">
                  <span class="dropdown-title">torchtext</span>
                  <p></p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item" href="https://pytorch.org/vision/stable/index.html">
                  <span class="dropdown-title">torchvision</span>
                  <p></p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item" href="https://pytorch.org/elastic/">
                  <span class="dropdown-title">TorchElastic</span>
                  <p></p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item" href="https://pytorch.org/serve/">
                  <span class="dropdown-title">TorchServe</span>
                  <p></p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item" href="https://pytorch.org/xla">
                  <span class="dropdown-title">PyTorch on XLA Devices</span>
                  <p></p>
                </a>
            </div>
          </li>

          <li>
            <div id="resourcesDropdownButton" data-toggle="resources-dropdown" class="resources-dropdown">
              <a class="resource-option with-down-arrow">
                Resources
              </a>
              <div class="resources-dropdown-menu">
                <a class="nav-dropdown-item" href="https://pytorch.org/features">
                  <span class="dropdown-title">About</span>
                  <p>Learn about PyTorch’s features and capabilities</p>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/#community-module">
                  <span class="dropdown-title">Community</span>
                  <p>Join the PyTorch developer community to contribute, learn, and get your questions answered.</p>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/resources">
                  <span class="dropdown-title">Developer Resources</span>
                  <p>Find resources and get questions answered</p>
                </a>
                <a class="nav-dropdown-item" href="https://discuss.pytorch.org/" target="_blank">
                  <span class="dropdown-title">Forums</span>
                  <p>A place to discuss PyTorch code, issues, install, research</p>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/hub">
                  <span class="dropdown-title">Models (Beta)</span>
                  <p>Discover, publish, and reuse pre-trained models</p>
                </a>
              </div>
            </div>
          </li>

          <li>
            <a href="https://github.com/pytorch/pytorch">GitHub</a>
          </li>
        </ul>
      </div>

      <a class="main-menu-open-button" href="#" data-behavior="open-mobile-menu"></a>
    </div>
  </div>
</div>

<body class="pytorch-body">

   

    

    <div class="table-of-contents-link-wrapper">
      <span>Table of Contents</span>
      <a href="#" class="toggle-table-of-contents" data-behavior="toggle-table-of-contents"></a>
    </div>

    <nav data-toggle="wy-nav-shift" class="pytorch-left-menu" id="pytorch-left-menu">
      <div class="pytorch-side-scroll">
        <div class="pytorch-menu pytorch-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          <div class="pytorch-left-menu-search">
            

            
              
              
                <div class="version">
                  v0.1.0.dev0
                </div>
              
            

            


  


<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search Docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

            
          </div>

          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Usage</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="basics.html">Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="cli.html">CLI</a></li>
<li class="toctree-l1"><a class="reference internal" href="configure.html">Configuring</a></li>
</ul>
<p class="caption"><span class="caption-text">API</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">torchx.specs</a></li>
<li class="toctree-l1"><a class="reference internal" href="components.html">torchx.components</a></li>
<li class="toctree-l1"><a class="reference internal" href="runner.html">torchx.runner</a></li>
<li class="toctree-l1"><a class="reference internal" href="schedulers.html">torchx.schedulers</a></li>
</ul>
<p class="caption"><span class="caption-text">Components</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="components/base.html">Base</a></li>
<li class="toctree-l1"><a class="reference internal" href="components/distributed.html">Distributed</a></li>
<li class="toctree-l1"><a class="reference internal" href="components/hpo.html">HPO</a></li>
<li class="toctree-l1"><a class="reference internal" href="components/utils.html">Utils</a></li>
</ul>
<p class="caption"><span class="caption-text">Schedulers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="schedulers/local.html">Localhost</a></li>
<li class="toctree-l1"><a class="reference internal" href="schedulers/kubernetes.html">Kubernetes</a></li>
<li class="toctree-l1"><a class="reference internal" href="schedulers/slurm.html">Slurm</a></li>
</ul>
<p class="caption"><span class="caption-text">Pipeline Adapters</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="pipelines/kfp.html">Kubeflow Pipelines</a></li>
</ul>
<p class="caption"><span class="caption-text">Beta Features</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="beta.html">Coming Soon</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <div class="pytorch-container">
      <div class="pytorch-page-level-bar" id="pytorch-page-level-bar">
        <div class="pytorch-breadcrumbs-wrapper">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="pytorch-breadcrumbs">
    
      <li>
        <a href="index.html">
          
            Docs
          
        </a> &gt;
      </li>

        
      <li>torchx.specs</li>
    
    
      <li class="pytorch-breadcrumbs-aside">
        
            
            <a href="_sources/specs.rst.txt" rel="nofollow"><img src="_static/images/view-page-source-icon.svg"></a>
          
        
      </li>
    
  </ul>

  
</div>
        </div>

        <div class="pytorch-shortcuts-wrapper" id="pytorch-shortcuts-wrapper">
          Shortcuts
        </div>
      </div>

      <section data-toggle="wy-nav-shift" id="pytorch-content-wrap" class="pytorch-content-wrap">
        <div class="pytorch-content-left">

        
          
          <div class="rst-content">
          
            <div role="main" class="main-content" itemscope="itemscope" itemtype="http://schema.org/Article">
             <article itemprop="articleBody" id="pytorch-article" class="pytorch-article">
              
  <div class="section" id="module-torchx.specs">
<span id="torchx-specs"></span><h1>torchx.specs<a class="headerlink" href="#module-torchx.specs" title="Permalink to this headline">¶</a></h1>
<div class="section" id="application">
<h2>Application<a class="headerlink" href="#application" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="torchx.specs.Application">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">torchx.specs.</span></code><code class="sig-name descname"><span class="pre">Application</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="pre">name:</span> <span class="pre">str</span></em>, <em class="sig-param"><span class="pre">roles:</span> <span class="pre">List[torchx.specs.api.Role]</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></em>, <em class="sig-param"><span class="pre">metadata:</span> <span class="pre">Dict[str</span></em>, <em class="sig-param"><span class="pre">str]</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchx/specs/api.html#Application"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchx.specs.Application" title="Permalink to this definition">¶</a></dt>
<dd><p>Represents a distributed application made up of multiple <code class="docutils literal notranslate"><span class="pre">Roles</span></code>
and metadata. Contains the necessary information for the driver
to submit this app to the scheduler.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – Name of application</p></li>
<li><p><strong>roles</strong> – List of roles</p></li>
<li><p><strong>metadata</strong> – Application specific configuration, in comparison
<code class="docutils literal notranslate"><span class="pre">RunConfig</span></code> is runtime specific configuration.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="torchx.specs.Application.add_metadata">
<code class="sig-name descname"><span class="pre">add_metadata</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">torchx.specs.api.Application</span><a class="reference internal" href="_modules/torchx/specs/api.html#Application.add_metadata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchx.specs.Application.add_metadata" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds metadata to the application.
.. note:: If the key already exists, this method overwrites the metadata value.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="role">
<h2>Role<a class="headerlink" href="#role" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="torchx.specs.Role">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">torchx.specs.</span></code><code class="sig-name descname"><span class="pre">Role</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="pre">name:</span> <span class="pre">str</span></em>, <em class="sig-param"><span class="pre">entrypoint:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">'&lt;MISSING&gt;'</span></em>, <em class="sig-param"><span class="pre">args:</span> <span class="pre">List[str]</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></em>, <em class="sig-param"><span class="pre">env:</span> <span class="pre">Dict[str</span></em>, <em class="sig-param"><span class="pre">str]</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></em>, <em class="sig-param"><span class="pre">container:</span> <span class="pre">torchx.specs.api.Container</span> <span class="pre">=</span> <span class="pre">Container(image='&lt;MISSING&gt;'</span></em>, <em class="sig-param"><span class="pre">base_image=None</span></em>, <em class="sig-param"><span class="pre">resources=Resource(cpu=-1</span></em>, <em class="sig-param"><span class="pre">gpu=-1</span></em>, <em class="sig-param"><span class="pre">memMB=-1</span></em>, <em class="sig-param"><span class="pre">capabilities={})</span></em>, <em class="sig-param"><span class="pre">port_map={})</span></em>, <em class="sig-param"><span class="pre">num_replicas:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1</span></em>, <em class="sig-param"><span class="pre">max_retries:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">0</span></em>, <em class="sig-param"><span class="pre">retry_policy:</span> <span class="pre">torchx.specs.api.RetryPolicy</span> <span class="pre">=</span> <span class="pre">&lt;RetryPolicy.APPLICATION:</span> <span class="pre">'APPLICATION'&gt;</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchx/specs/api.html#Role"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchx.specs.Role" title="Permalink to this definition">¶</a></dt>
<dd><p>A set of nodes that perform a specific duty within the <code class="docutils literal notranslate"><span class="pre">Application</span></code>.
Examples:</p>
<ol class="arabic simple">
<li><p>Distributed data parallel app - made up of a single role (trainer).</p></li>
<li><p>App with parameter server - made up of multiple roles (trainer, ps).</p></li>
</ol>
<p>Usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">trainer</span> <span class="o">=</span> <span class="n">Role</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;trainer&quot;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">runs</span><span class="p">(</span><span class="s2">&quot;my_trainer.py&quot;</span><span class="p">,</span> <span class="s2">&quot;--arg&quot;</span><span class="p">,</span> <span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="n">ENV_VAR</span><span class="o">=</span><span class="s2">&quot;FOOBAR&quot;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="n">container</span><span class="p">)</span>
            <span class="o">.</span><span class="n">replicas</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – name of the role</p></li>
<li><p><strong>entrypoint</strong> – command (within the container) to invoke the role</p></li>
<li><p><strong>args</strong> – commandline arguments to the entrypoint cmd</p></li>
<li><p><strong>env</strong> – environment variable mappings</p></li>
<li><p><strong>container</strong> – container to run in</p></li>
<li><p><strong>replicas</strong> – number of container replicas to run</p></li>
<li><p><strong>max_retries</strong> – max number of retries before giving up</p></li>
<li><p><strong>retry_policy</strong> – retry behavior upon replica failures</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="torchx.specs.Role.pre_proc">
<code class="sig-name descname"><span class="pre">pre_proc</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scheduler</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dryrun_info</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">torchx.specs.api.AppDryRunInfo</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">torchx.specs.api.AppDryRunInfo</span><a class="reference internal" href="_modules/torchx/specs/api.html#Role.pre_proc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchx.specs.Role.pre_proc" title="Permalink to this definition">¶</a></dt>
<dd><p>Modifies the scheduler request based on the role specific configuration.
The method is invoked for each role during scheduler <code class="docutils literal notranslate"><span class="pre">submit_dryrun</span></code>.
If there are multiple roles, the method is invoked for each role in
order that is defined by the <code class="docutils literal notranslate"><span class="pre">Application.roles</span></code> list.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="torchx.specs.ElasticRole">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">torchx.specs.</span></code><code class="sig-name descname"><span class="pre">ElasticRole</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">launch_kwargs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchx/specs/api.html#ElasticRole"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchx.specs.ElasticRole" title="Permalink to this definition">¶</a></dt>
<dd><p>A <code class="docutils literal notranslate"><span class="pre">Role</span></code> for which the user provided <code class="docutils literal notranslate"><span class="pre">entrypoint</span></code> is executed with the
torchelastic agent (in the container). Note that the torchelastic agent
invokes multiple copies of <code class="docutils literal notranslate"><span class="pre">entrypoint</span></code>.</p>
<p>For more information about torchelastic see
<a class="reference external" href="http://pytorch.org/elastic/0.2.0/quickstart.html">torchelastic quickstart docs</a>.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>It is the responsibility of the user to ensure that the
container’s image includes torchelastic. Since Torchx has no
control over the build process of the image, it cannot
automatically include torchelastic in the container’s image.</p>
</div>
<p>The following example launches 2 <code class="docutils literal notranslate"><span class="pre">replicas</span></code> (nodes) of an elastic <code class="docutils literal notranslate"><span class="pre">my_train_script.py</span></code>
that is allowed to scale between 2 to 4 nodes. Each node runs 8 workers which are allowed
to fail and restart a maximum of 3 times.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><code class="docutils literal notranslate"><span class="pre">replicas</span></code> MUST BE an integer between (inclusive) <code class="docutils literal notranslate"><span class="pre">nnodes</span></code>. That is,
<code class="docutils literal notranslate"><span class="pre">ElasticRole(&quot;trainer&quot;,</span> <span class="pre">nnodes=&quot;2:4&quot;).replicas(5)</span></code> is invalid and will
result in undefined behavior.</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">elastic_trainer</span> <span class="o">=</span> <span class="n">ElasticRole</span><span class="p">(</span><span class="s2">&quot;trainer&quot;</span><span class="p">,</span> <span class="n">nproc_per_node</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">nnodes</span><span class="o">=</span><span class="s2">&quot;2:4&quot;</span><span class="p">,</span> <span class="n">max_restarts</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
                   <span class="o">.</span><span class="n">runs</span><span class="p">(</span><span class="s2">&quot;my_train_script.py&quot;</span><span class="p">,</span> <span class="s2">&quot;--script_arg&quot;</span><span class="p">,</span> <span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="s2">&quot;--another_arg&quot;</span><span class="p">,</span> <span class="s2">&quot;bar&quot;</span><span class="p">)</span>
                   <span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="n">container</span><span class="p">)</span>
                   <span class="o">.</span><span class="n">replicas</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># effectively runs:</span>
<span class="c1">#    python -m torchelastic.distributed.launch</span>
<span class="c1">#        --nproc_per_node 8</span>
<span class="c1">#        --nnodes 2:4</span>
<span class="c1">#        --max_restarts 3</span>
<span class="c1">#        my_train_script.py --script_arg foo --another_arg bar</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt id="torchx.specs.RetryPolicy">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">torchx.specs.</span></code><code class="sig-name descname"><span class="pre">RetryPolicy</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchx/specs/api.html#RetryPolicy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchx.specs.RetryPolicy" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the retry policy for the <code class="docutils literal notranslate"><span class="pre">Roles</span></code> in the <code class="docutils literal notranslate"><span class="pre">Application</span></code>.
The policy defines the behavior when the role replica encounters a failure:</p>
<ol class="arabic simple">
<li><p>unsuccessful (non zero) exit code</p></li>
<li><p>hardware/host crashes</p></li>
<li><p>preemption</p></li>
<li><p>eviction</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Not all retry policies are supported by all schedulers.
However all schedulers must support <code class="docutils literal notranslate"><span class="pre">RetryPolicy.APPLICATION</span></code>.
Please refer to the scheduler’s documentation for more information
on the retry policies they support and behavior caveats (if any).</p>
</div>
<ol class="arabic simple">
<li><dl class="simple">
<dt>REPLICA: Replaces the replica instance. Surviving replicas are untouched.</dt><dd><p>Use with <code class="docutils literal notranslate"><span class="pre">ElasticRole</span></code> to have torchelastic coordinate restarts
and membership changes. Otherwise, it is up to the application to
deal with failed replica departures and replacement replica admittance.</p>
</dd>
</dl>
</li>
<li><p>APPLICATION: Restarts the entire application.</p></li>
</ol>
</dd></dl>

</div>
<div class="section" id="container">
<h2>Container<a class="headerlink" href="#container" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="torchx.specs.Container">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">torchx.specs.</span></code><code class="sig-name descname"><span class="pre">Container</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="pre">image:</span> <span class="pre">str</span></em>, <em class="sig-param"><span class="pre">base_image:</span> <span class="pre">Optional[str]</span> <span class="pre">=</span> <span class="pre">None</span></em>, <em class="sig-param"><span class="pre">resources:</span> <span class="pre">torchx.specs.api.Resource</span> <span class="pre">=</span> <span class="pre">Resource(cpu=-1</span></em>, <em class="sig-param"><span class="pre">gpu=-1</span></em>, <em class="sig-param"><span class="pre">memMB=-1</span></em>, <em class="sig-param"><span class="pre">capabilities={})</span></em>, <em class="sig-param"><span class="pre">port_map:</span> <span class="pre">Dict[str</span></em>, <em class="sig-param"><span class="pre">int]</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchx/specs/api.html#Container"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchx.specs.Container" title="Permalink to this definition">¶</a></dt>
<dd><p>Represents the specifications of the container that instances of <code class="docutils literal notranslate"><span class="pre">Roles</span></code>
run on. Maps to the container abstraction that the underlying scheduler
supports. This could be an actual container (e.g. Docker) or a physical
instance depending on the scheduler.</p>
<p>An <code class="docutils literal notranslate"><span class="pre">image</span></code> is a software bundle that is installed on a <code class="docutils literal notranslate"><span class="pre">Container</span></code>.
The container on the scheduler dictates what an image actually is.
An image could be as simple as a tar-ball or map to a docker image.
The scheduler typically knows how to “pull” the image given an
image name (str), which could be a simple name (e.g. docker image) or a url
(e.g. <code class="docutils literal notranslate"><span class="pre">s3://path/my_image.tar</span></code>).</p>
<p>A <code class="docutils literal notranslate"><span class="pre">Resource</span></code> can be bound to a specific scheduler backend or <code class="docutils literal notranslate"><span class="pre">SchedulerBackend.ALL</span></code> (default)
to specify that the same <code class="docutils literal notranslate"><span class="pre">Resource</span></code> is to be used for all schedulers.</p>
<p>An optional <code class="docutils literal notranslate"><span class="pre">base_image</span></code> can be specified if the scheduler supports a
concept of base images. For schedulers that run Docker containers the
base image is not useful since the application image itself can be
built from a base image (using the <code class="docutils literal notranslate"><span class="pre">FROM</span> <span class="pre">base/image:latest</span></code> construct in
the Dockerfile). However the base image is useful for schedulers that
work with simple image artifacts (e.g. <code class="docutils literal notranslate"><span class="pre">*.tar.gz</span></code>) that do not have a built-in
concept of base images. For these schedulers, specifying a base image that
includes dependencies while the main image is the actual application code
makes it possible to make changes to the application code without incurring
the cost of re-building the uber artifact.</p>
<p>Usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">my_container</span> <span class="o">=</span> <span class="n">Container</span><span class="p">(</span>
   <span class="n">image</span><span class="o">=</span><span class="s2">&quot;pytorch/torch:1&quot;</span><span class="p">,</span>
   <span class="n">resources</span><span class="o">=</span><span class="n">Resource</span><span class="p">(</span><span class="n">cpu</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">gpu</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">memMB</span><span class="o">=</span><span class="mi">500</span><span class="p">),</span>
   <span class="n">port_map</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;tcp_store&quot;</span><span class="p">:</span><span class="mi">8080</span><span class="p">,</span> <span class="s2">&quot;tensorboard&quot;</span><span class="p">:</span> <span class="mi">8081</span><span class="p">}</span>
<span class="p">)</span>

<span class="c1"># for schedulers that support base_images</span>
<span class="n">my_container</span> <span class="o">=</span> <span class="n">Container</span><span class="p">(</span>
   <span class="n">image</span><span class="o">=</span><span class="s2">&quot;my/trainer:1&quot;</span><span class="p">,</span>
   <span class="n">base_image</span><span class="o">=</span><span class="s2">&quot;common/ml-tools:latest&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt id="torchx.specs.Container.ports">
<code class="sig-name descname"><span class="pre">ports</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">torchx.specs.api.Container</span><a class="reference internal" href="_modules/torchx/specs/api.html#Container.ports"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchx.specs.Container.ports" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a port mapping for the container</p>
</dd></dl>

<dl class="py method">
<dt id="torchx.specs.Container.require">
<code class="sig-name descname"><span class="pre">require</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">resources</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">torchx.specs.api.Resource</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">torchx.specs.api.Container</span><a class="reference internal" href="_modules/torchx/specs/api.html#Container.require"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchx.specs.Container.require" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets resource requirements on the container.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="resource">
<h2>Resource<a class="headerlink" href="#resource" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="torchx.specs.Resource">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">torchx.specs.</span></code><code class="sig-name descname"><span class="pre">Resource</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="pre">cpu:</span> <span class="pre">int</span></em>, <em class="sig-param"><span class="pre">gpu:</span> <span class="pre">int</span></em>, <em class="sig-param"><span class="pre">memMB:</span> <span class="pre">int</span></em>, <em class="sig-param"><span class="pre">capabilities:</span> <span class="pre">Dict[str</span></em>, <em class="sig-param"><span class="pre">Any]</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchx/specs/api.html#Resource"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchx.specs.Resource" title="Permalink to this definition">¶</a></dt>
<dd><p>Represents resource requirements for a <code class="docutils literal notranslate"><span class="pre">Container</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cpu</strong> – number of cpu cores (note: not hyper threads)</p></li>
<li><p><strong>gpu</strong> – number of gpus</p></li>
<li><p><strong>memMB</strong> – MB of ram</p></li>
<li><p><strong>capabilities</strong> – additional hardware specs (interpreted by scheduler)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="torchx.specs.Resource.copy">
<em class="property"><span class="pre">static</span> </em><code class="sig-name descname"><span class="pre">copy</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">original</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">torchx.specs.api.Resource</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">capabilities</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">torchx.specs.api.Resource</span><a class="reference internal" href="_modules/torchx/specs/api.html#Resource.copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchx.specs.Resource.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Copies a resource and applies new capabilities. If the same capabilities
are present in the original resource and as parameter, the one from parameter
will be used.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="macros">
<h2>Macros<a class="headerlink" href="#macros" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="torchx.specs.macros">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">torchx.specs.</span></code><code class="sig-name descname"><span class="pre">macros</span></code><a class="reference internal" href="_modules/torchx/specs/api.html#macros"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchx.specs.macros" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines macros that can be used with <code class="docutils literal notranslate"><span class="pre">Role.entrypoint</span></code> and <code class="docutils literal notranslate"><span class="pre">Role.args</span></code>.
The macros will be substituted at runtime to their actual values.</p>
<p>Available macros:</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">img_root</span></code> - root directory of the pulled conatiner.image</p></li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">base_img_root</span></code> - root directory of the pulled container.base_image</dt><dd><p>(resolves to “&lt;NONE&gt;” if no base_image set)</p>
</dd>
</dl>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">app_id</span></code> - application id as assigned by the scheduler</p></li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">replica_id</span></code> - unique id for each instance of a replica of a Role,</dt><dd><p>for instance a role with 3 replicas could have the 0, 1, 2
as replica ids. Note that when the container fails and is
replaced, the new container will have the same <code class="docutils literal notranslate"><span class="pre">replica_id</span></code>
as the one it is replacing. For instance if node 1 failed and
was replaced by the scheduler the replacing node will also
have <code class="docutils literal notranslate"><span class="pre">replica_id=1</span></code>.</p>
</dd>
</dl>
</li>
</ol>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># runs: hello_world.py --app_id ${app_id}</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Role</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;trainer&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">runs</span><span class="p">(</span><span class="s2">&quot;hello_world.py&quot;</span><span class="p">,</span> <span class="s2">&quot;--app_id&quot;</span><span class="p">,</span> <span class="n">macros</span><span class="o">.</span><span class="n">app_id</span><span class="p">)</span>
<span class="n">app</span> <span class="o">=</span> <span class="n">Application</span><span class="p">(</span><span class="s2">&quot;train_app&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">of</span><span class="p">(</span><span class="n">trainer</span><span class="p">)</span>
<span class="n">app_handle</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">app</span><span class="p">,</span> <span class="n">scheduler</span><span class="o">=</span><span class="s2">&quot;local&quot;</span><span class="p">,</span> <span class="n">cfg</span><span class="o">=</span><span class="n">RunConfig</span><span class="p">())</span>
</pre></div>
</div>
<dl class="py class">
<dt id="torchx.specs.macros.Values">
<em class="property"><span class="pre">class</span> </em><code class="sig-name descname"><span class="pre">Values</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_root</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">app_id</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">replica_id</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_img_root</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'&lt;NONE&gt;'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchx/specs/api.html#macros.Values"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchx.specs.macros.Values" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt id="torchx.specs.macros.Values.apply">
<code class="sig-name descname"><span class="pre">apply</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">role</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">torchx.specs.api.Role</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">torchx.specs.api.Role</span><a class="reference internal" href="_modules/torchx/specs/api.html#macros.Values.apply"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchx.specs.macros.Values.apply" title="Permalink to this definition">¶</a></dt>
<dd><p>apply applies the values to a copy the specified role and returns it.</p>
</dd></dl>

<dl class="py method">
<dt id="torchx.specs.macros.Values.substitute">
<code class="sig-name descname"><span class="pre">substitute</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arg</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a><a class="reference internal" href="_modules/torchx/specs/api.html#macros.Values.substitute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchx.specs.macros.Values.substitute" title="Permalink to this definition">¶</a></dt>
<dd><p>substitute applies the values to the template arg.</p>
</dd></dl>

</dd></dl>

</dd></dl>

</div>
<div class="section" id="run-configs">
<h2>Run Configs<a class="headerlink" href="#run-configs" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="torchx.specs.RunConfig">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">torchx.specs.</span></code><code class="sig-name descname"><span class="pre">RunConfig</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="pre">cfgs:</span> <span class="pre">Dict[str</span></em>, <em class="sig-param"><span class="pre">Optional[Union[str</span></em>, <em class="sig-param"><span class="pre">int</span></em>, <em class="sig-param"><span class="pre">float</span></em>, <em class="sig-param"><span class="pre">bool</span></em>, <em class="sig-param"><span class="pre">List[str]]]]</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchx/specs/api.html#RunConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchx.specs.RunConfig" title="Permalink to this definition">¶</a></dt>
<dd><p>Additional run configs for the app. These are typically
scheduler runtime configs/arguments that do not bind
to <code class="docutils literal notranslate"><span class="pre">Application</span></code> nor the <code class="docutils literal notranslate"><span class="pre">Scheduler</span></code>. For example
a particular cluster (within the scheduler) the application
should be submitted to. Since the same app can be launched
into multiple types of clusters (devo, prod) the
cluster id config does not bind to the app. Neither
does this bind to the scheduler since the cluster can
be partitioned by size of the instances (S, M, L) or by
a preemption setting (e.g. on-demand vs spot).</p>
<p>Since <code class="docutils literal notranslate"><span class="pre">Session</span></code> allows the application to be submitted
to multiple schedulers, users who want to submit the same
app into multiple schedulers from the same session can
union all the <code class="docutils literal notranslate"><span class="pre">RunConfigs</span></code> into a single object. The
scheduler implementation will selectively read the configs
it needs.</p>
<p>This class is intended to be trivially serialized and
passed around or saved hence only allow primitives
as config values. Should the scheduler need more than
simple primitives (e.g. list of str) it is up to the
scheduler to document a way to encode this value as a
str and parse it (e.g. representing list of str as
comma delimited str).</p>
<p>Usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># write</span>
<span class="n">config</span> <span class="o">=</span> <span class="n">RunConfig</span><span class="p">()</span>
<span class="n">config</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;run_as_user&quot;</span><span class="p">,</span> <span class="s2">&quot;prod&quot;</span><span class="p">)</span>
<span class="n">config</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;priority&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

<span class="c1"># read</span>
<span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;run_as_user&quot;</span><span class="p">)</span> <span class="c1"># &quot;prod&quot;</span>
<span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;priority&quot;</span><span class="p">)</span> <span class="c1"># 10</span>
<span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;never_set&quot;</span><span class="p">)</span> <span class="c1"># None</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt id="torchx.specs.runopts">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">torchx.specs.</span></code><code class="sig-name descname"><span class="pre">runopts</span></code><a class="reference internal" href="_modules/torchx/specs/api.html#runopts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchx.specs.runopts" title="Permalink to this definition">¶</a></dt>
<dd><p>Holds the accepted scheduler run configuration
keys, default value (if any), and help message string.
These options are provided by the <code class="docutils literal notranslate"><span class="pre">Scheduler</span></code> and validated
in <code class="docutils literal notranslate"><span class="pre">Session.run</span></code> against user provided <code class="docutils literal notranslate"><span class="pre">RunConfig</span></code>.
Allows <code class="docutils literal notranslate"><span class="pre">None</span></code> default values. Required opts must NOT have a
non-None default.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>This class has no accessors because it is intended to
be constructed and returned by <code class="docutils literal notranslate"><span class="pre">Scheduler.run_config_options</span></code>
and printed out as a “help” tool or as part of an exception msg.</p>
</div>
<p>Usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">opts</span> <span class="o">=</span> <span class="n">runopts</span><span class="p">()</span>

<span class="n">opts</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;run_as_user&quot;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;user to run the job as&quot;</span><span class="p">)</span>
<span class="n">opts</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;cluster_id&quot;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;cluster to submit the job&quot;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">opts</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;priority&quot;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;job priority&quot;</span><span class="p">)</span>
<span class="n">opts</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;preemptible&quot;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="nb">bool</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;is the job preemptible&quot;</span><span class="p">)</span>

<span class="c1"># invalid</span>
<span class="n">opts</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;illegal&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">opts</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;bad_type&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">opts</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="n">RunConfig</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">opts</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt id="torchx.specs.runopts.add">
<code class="sig-name descname"><span class="pre">add</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg_key</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">type_</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Type</span><span class="p"><span class="pre">[</span></span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><span class="pre">float</span></a><span class="p"><span class="pre">,</span> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><span class="pre">bool</span></a><span class="p"><span class="pre">,</span> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">help</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">default</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><span class="pre">float</span></a><span class="p"><span class="pre">,</span> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><span class="pre">bool</span></a><span class="p"><span class="pre">,</span> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">required</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><span class="pre">bool</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><span class="pre">None</span></a><a class="reference internal" href="_modules/torchx/specs/api.html#runopts.add"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchx.specs.runopts.add" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds the <code class="docutils literal notranslate"><span class="pre">config</span></code> option with the given help string and <code class="docutils literal notranslate"><span class="pre">default</span></code>
value (if any). If the <code class="docutils literal notranslate"><span class="pre">default</span></code> is not specified then this option
is a required option.</p>
</dd></dl>

<dl class="py method">
<dt id="torchx.specs.runopts.is_type">
<em class="property"><span class="pre">static</span> </em><code class="sig-name descname"><span class="pre">is_type</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><span class="pre">float</span></a><span class="p"><span class="pre">,</span> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><span class="pre">bool</span></a><span class="p"><span class="pre">,</span> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tp</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Type</span><span class="p"><span class="pre">[</span></span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><span class="pre">float</span></a><span class="p"><span class="pre">,</span> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><span class="pre">bool</span></a><span class="p"><span class="pre">,</span> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><span class="pre">bool</span></a><a class="reference internal" href="_modules/torchx/specs/api.html#runopts.is_type"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchx.specs.runopts.is_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if <code class="docutils literal notranslate"><span class="pre">obj</span></code> is type of <code class="docutils literal notranslate"><span class="pre">tp</span></code>. Similar to isinstance() but supports
tp = List[str], thus can be used to validate ConfigValue.</p>
</dd></dl>

<dl class="py method">
<dt id="torchx.specs.runopts.resolve">
<code class="sig-name descname"><span class="pre">resolve</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">torchx.specs.api.RunConfig</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">torchx.specs.api.RunConfig</span><a class="reference internal" href="_modules/torchx/specs/api.html#runopts.resolve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchx.specs.runopts.resolve" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks the given config against this <code class="docutils literal notranslate"><span class="pre">runopts</span></code> and sets default configs
if not set.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This method mutates the provided config!</p>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="run-status">
<h2>Run Status<a class="headerlink" href="#run-status" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="torchx.specs.AppStatus">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">torchx.specs.</span></code><code class="sig-name descname"><span class="pre">AppStatus</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="pre">state:</span> <span class="pre">torchx.specs.api.AppState</span></em>, <em class="sig-param"><span class="pre">num_restarts:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">0</span></em>, <em class="sig-param"><span class="pre">msg:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">''</span></em>, <em class="sig-param"><span class="pre">structured_error_msg:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">'&lt;NONE&gt;'</span></em>, <em class="sig-param"><span class="pre">ui_url:</span> <span class="pre">Optional[str]</span> <span class="pre">=</span> <span class="pre">None</span></em>, <em class="sig-param"><span class="pre">roles:</span> <span class="pre">List[torchx.specs.api.RoleStatus]</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchx/specs/api.html#AppStatus"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchx.specs.AppStatus" title="Permalink to this definition">¶</a></dt>
<dd><p>The runtime status of the <code class="docutils literal notranslate"><span class="pre">Application</span></code>. The scheduler can
return an arbitrary text message (msg field).
If any error occurs, scheduler can populate <code class="docutils literal notranslate"><span class="pre">structured_error_msg</span></code>
with json response.</p>
<p><code class="docutils literal notranslate"><span class="pre">replicas</span></code> represent the statuses of the replicas in the job. If the job
runs with multiple retries, the parameter will contain the statuses of the
most recent retry. Note: if the previous retries failed, but the most recent
retry succeeded or in progress, <code class="docutils literal notranslate"><span class="pre">replicas</span></code> will not contain ocurred errors.</p>
</dd></dl>

<dl class="py class">
<dt id="torchx.specs.AppState">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">torchx.specs.</span></code><code class="sig-name descname"><span class="pre">AppState</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchx/specs/api.html#AppState"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchx.specs.AppState" title="Permalink to this definition">¶</a></dt>
<dd><p>State of the application. An application starts from an initial
<code class="docutils literal notranslate"><span class="pre">UNSUBMITTED</span></code> state and moves through <code class="docutils literal notranslate"><span class="pre">SUBMITTED</span></code>, <code class="docutils literal notranslate"><span class="pre">PENDING</span></code>,
<code class="docutils literal notranslate"><span class="pre">RUNNING</span></code> states finally reaching a terminal state:
<code class="docutils literal notranslate"><span class="pre">SUCCEEDED</span></code>,``FAILED``, <code class="docutils literal notranslate"><span class="pre">CANCELLED</span></code>.</p>
<p>If the scheduler supports preemption, the app moves from a <code class="docutils literal notranslate"><span class="pre">RUNNING</span></code>
state to <code class="docutils literal notranslate"><span class="pre">PENDING</span></code> upon preemption.</p>
<p>If the user stops the application, then the application state moves
to <code class="docutils literal notranslate"><span class="pre">STOPPED</span></code>, then to <code class="docutils literal notranslate"><span class="pre">CANCELLED</span></code> when the job is actually cancelled
by the scheduler.</p>
<ol class="arabic simple">
<li><p>UNSUBMITTED - app has not been submitted to the scheduler yet</p></li>
<li><p>SUBMITTED - app has been successfully submitted to the scheduler</p></li>
<li><p>PENDING - app has been submitted to the scheduler pending allocation</p></li>
<li><p>RUNNING - app is running</p></li>
<li><p>SUCCEEDED - app has successfully completed</p></li>
<li><p>FAILED - app has unsuccessfully completed</p></li>
<li><p>CANCELLED - app was cancelled before completing</p></li>
</ol>
</dd></dl>

<dl class="py attribute">
<dt id="torchx.specs.ReplicaState">
<code class="sig-prename descclassname"><span class="pre">torchx.specs.</span></code><code class="sig-name descname"><span class="pre">ReplicaState</span></code><a class="headerlink" href="#torchx.specs.ReplicaState" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">torchx.specs.api.AppState</span></code></p>
</dd></dl>

</div>
</div>


             </article>
             
            </div>
            <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="components.html" class="btn btn-neutral float-right" title="torchx.components" accesskey="n" rel="next">Next <img src="_static/images/chevron-right-orange.svg" class="next-page"></a>
      
      
        <a href="configure.html" class="btn btn-neutral" title="Configuring" accesskey="p" rel="prev"><img src="_static/images/chevron-right-orange.svg" class="previous-page"> Previous</a>
      
    </div>
  

  

    <hr>

  

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, TorchX Contributors.

    </p>
  </div>
    
      <div>
        Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
      </div>
     

</footer>

          </div>
        </div>

        <div class="pytorch-content-right" id="pytorch-content-right">
          <div class="pytorch-right-menu" id="pytorch-right-menu">
            <div class="pytorch-side-scroll" id="pytorch-side-scroll-right">
              <ul>
<li><a class="reference internal" href="#">torchx.specs</a><ul>
<li><a class="reference internal" href="#application">Application</a></li>
<li><a class="reference internal" href="#role">Role</a></li>
<li><a class="reference internal" href="#container">Container</a></li>
<li><a class="reference internal" href="#resource">Resource</a></li>
<li><a class="reference internal" href="#macros">Macros</a></li>
<li><a class="reference internal" href="#run-configs">Run Configs</a></li>
<li><a class="reference internal" href="#run-status">Run Status</a></li>
</ul>
</li>
</ul>

            </div>
          </div>
        </div>
      </section>
    </div>

  


  

     
       <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
         <script src="_static/jquery.js"></script>
         <script src="_static/underscore.js"></script>
         <script src="_static/doctools.js"></script>
         <script src="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.js"></script>
         <script src="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/contrib/auto-render.min.js"></script>
         <script src="_static/katex_autorenderer.js"></script>
     

  

  <script type="text/javascript" src="_static/js/vendor/popper.min.js"></script>
  <script type="text/javascript" src="_static/js/vendor/bootstrap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/list.js/1.5.0/list.min.js"></script>
  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

  <!-- Begin Footer -->

  <div class="container-fluid docs-tutorials-resources" id="docs-tutorials-resources">
    <div class="container">
      <div class="row">
        <div class="col-md-4 text-center">
          <h2>Docs</h2>
          <p>Access comprehensive developer documentation for PyTorch</p>
          <a class="with-right-arrow" href="https://pytorch.org/docs/stable/index.html">View Docs</a>
        </div>

        <div class="col-md-4 text-center">
          <h2>Tutorials</h2>
          <p>Get in-depth tutorials for beginners and advanced developers</p>
          <a class="with-right-arrow" href="https://pytorch.org/tutorials">View Tutorials</a>
        </div>

        <div class="col-md-4 text-center">
          <h2>Resources</h2>
          <p>Find development resources and get your questions answered</p>
          <a class="with-right-arrow" href="https://pytorch.org/resources">View Resources</a>
        </div>
      </div>
    </div>
  </div>

  <footer class="site-footer">
    <div class="container footer-container">
      <div class="footer-logo-wrapper">
        <a href="https://pytorch.org/" class="footer-logo"></a>
      </div>

      <div class="footer-links-wrapper">
        <div class="footer-links-col">
          <ul>
            <li class="list-title"><a href="https://pytorch.org/">PyTorch</a></li>
            <li><a href="https://pytorch.org/get-started">Get Started</a></li>
            <li><a href="https://pytorch.org/features">Features</a></li>
            <li><a href="https://pytorch.org/ecosystem">Ecosystem</a></li>
            <li><a href="https://pytorch.org/blog/">Blog</a></li>
            <li><a href="https://github.com/pytorch/pytorch/blob/master/CONTRIBUTING.md">Contributing</a></li>
          </ul>
        </div>

        <div class="footer-links-col">
          <ul>
            <li class="list-title"><a href="https://pytorch.org/resources">Resources</a></li>
            <li><a href="https://pytorch.org/tutorials">Tutorials</a></li>
            <li><a href="https://pytorch.org/docs/stable/index.html">Docs</a></li>
            <li><a href="https://discuss.pytorch.org" target="_blank">Discuss</a></li>
            <li><a href="https://github.com/pytorch/pytorch/issues" target="_blank">Github Issues</a></li>
            <li><a href="https://pytorch.org/assets/brand-guidelines/PyTorch-Brand-Guidelines.pdf" target="_blank">Brand Guidelines</a></li>
          </ul>
        </div>

        <div class="footer-links-col follow-us-col">
          <ul>
            <li class="list-title">Stay Connected</li>
            <li>
              <div id="mc_embed_signup">
                <form
                  action="https://twitter.us14.list-manage.com/subscribe/post?u=75419c71fe0a935e53dfa4a3f&id=91d0dccd39"
                  method="post"
                  id="mc-embedded-subscribe-form"
                  name="mc-embedded-subscribe-form"
                  class="email-subscribe-form validate"
                  target="_blank"
                  novalidate>
                  <div id="mc_embed_signup_scroll" class="email-subscribe-form-fields-wrapper">
                    <div class="mc-field-group">
                      <label for="mce-EMAIL" style="display:none;">Email Address</label>
                      <input type="email" value="" name="EMAIL" class="required email" id="mce-EMAIL" placeholder="Email Address">
                    </div>

                    <div id="mce-responses" class="clear">
                      <div class="response" id="mce-error-response" style="display:none"></div>
                      <div class="response" id="mce-success-response" style="display:none"></div>
                    </div>    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->

                    <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_75419c71fe0a935e53dfa4a3f_91d0dccd39" tabindex="-1" value=""></div>

                    <div class="clear">
                      <input type="submit" value="" name="subscribe" id="mc-embedded-subscribe" class="button email-subscribe-button">
                    </div>
                  </div>
                </form>
              </div>

            </li>
          </ul>

          <div class="footer-social-icons">
            <a href="https://www.facebook.com/pytorch" target="_blank" class="facebook"></a>
            <a href="https://twitter.com/pytorch" target="_blank" class="twitter"></a>
            <a href="https://www.youtube.com/pytorch" target="_blank" class="youtube"></a>
          </div>
        </div>
      </div>
    </div>
  </footer>

  <div class="cookie-banner-wrapper">
  <div class="container">
    <p class="gdpr-notice">To analyze traffic and optimize your experience, we serve cookies on this site. By clicking or navigating, you agree to allow our usage of cookies. As the current maintainers of this site, Facebook’s Cookies Policy applies. Learn more, including about available controls: <a href="https://www.facebook.com/policies/cookies/">Cookies Policy</a>.</p>
    <img class="close-button" src="_static/images/pytorch-x.svg">
  </div>
</div>

  <!-- End Footer -->

  <!-- Begin Mobile Menu -->

  <div class="mobile-main-menu">
    <div class="container-fluid">
      <div class="container">
        <div class="mobile-main-menu-header-container">
          <a class="header-logo" href="https://pytorch.org/" aria-label="PyTorch"></a>
          <a class="main-menu-close-button" href="#" data-behavior="close-mobile-menu"></a>
        </div>
      </div>
    </div>

    <div class="mobile-main-menu-links-container">
      <div class="main-menu">
        <ul>
          <li>
            <a href="https://pytorch.org/get-started">Get Started</a>
          </li>

          <li>
            <a href="https://pytorch.org/ecosystem">Ecosystem</a>
          </li>

          <li>
            <a href="https://pytorch.org/mobile">Mobile</a>
          </li>

          <li>
            <a href="https://pytorch.org/hub">PyTorch Hub</a>
          </li>

          <li>
            <a href="https://pytorch.org/blog/">Blog</a>
          </li>

          <li>
            <a href="https://pytorch.org/tutorials">Tutorials</a>
          </li>

          <li class="resources-mobile-menu-title">
            Docs
          </li>

          <ul class="resources-mobile-menu-items">
            <li>
              <a href="https://pytorch.org/docs/stable/index.html">PyTorch</a>
            </li>

            <li>
              <a href="https://pytorch.org/audio/stable/index.html">torchaudio</a>
            </li>

            <li>
              <a href="https://pytorch.org/text/stable/index.html">torchtext</a>
            </li>

            <li>
              <a href="https://pytorch.org/vision/stable/index.html">torchvision</a>
            </li>

            <li>
              <a href="https://pytorch.org/elastic/">TorchElastic</a>
            </li>

            <li>
              <a href="https://pytorch.org/serve/">TorchServe</a>
            </li>

            <li>
              <a href="https://pytorch.org/xla">PyTorch on XLA Devices</a>
            </li>
          </ul>

          <li class="resources-mobile-menu-title">
            Resources
          </li>

          <ul class="resources-mobile-menu-items">
            <li>
              <a href="https://pytorch.org/resources">Developer Resources</a>
            </li>

            <li>
              <a href="https://pytorch.org/features">About</a>
            </li>

            <li>
              <a href="https://pytorch.org/hub">Models (Beta)</a>
            </li>

            <li>
              <a href="https://pytorch.org/#community-module">Community</a>
            </li>

            <li>
              <a href="https://discuss.pytorch.org/">Forums</a>
            </li>
          </ul>

          <li>
            <a href="https://github.com/pytorch/pytorch">Github</a>
          </li>
        </ul>
      </div>
    </div>
  </div>

  <!-- End Mobile Menu -->

  <script type="text/javascript" src="_static/js/vendor/anchor.min.js"></script>

  <script type="text/javascript">
    $(document).ready(function() {
      mobileMenu.bind();
      mobileTOC.bind();
      pytorchAnchors.bind();
      sideMenus.bind();
      scrollToAnchor.bind();
      highlightNavigation.bind();
      mainMenuDropdown.bind();
      filterTags.bind();

      // Add class to links that have code blocks, since we cannot create links in code blocks
      $("article.pytorch-article a span.pre").each(function(e) {
        $(this).closest("a").addClass("has-code");
      });
    })
  </script>
</body>
</html>